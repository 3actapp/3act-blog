{{- define "main" }}

{{- if .IsHome }}
<!-- Hero Section — content-first, no aggressive CTA -->
<section class="hero-section">
  <div class="hero-content animate-in">
    <span class="section-label">The Accountability Blog</span>
    <h1>Build Better Habits, <span>Together</span></h1>
    <p>Science-backed strategies for accountability, habit formation, and personal growth. Your guide to showing up every day and achieving your goals with the power of community.</p>
    <div class="hero-buttons">
      <a href="/categories/" class="btn-primary">Explore Articles</a>
      <a href="https://3act.app" class="btn-secondary" target="_blank" rel="noopener">Visit 3act.app</a>
    </div>
  </div>
  <div class="hero-illustration animate-in">
    <img src="/images/hero-illustration.jpg" alt="Friends building habits together" width="500" height="279" loading="eager">
  </div>
</section>

<!-- Social Proof -->
<section class="social-proof">
  <div class="proof-item">
    <span class="number">5.0 ★</span>
    <span class="label">App Store Rating</span>
  </div>
  <div class="proof-item">
    <span class="number">10K+</span>
    <span class="label">Habits Tracked</span>
  </div>
  <div class="proof-item">
    <span class="number">95%</span>
    <span class="label">Success with Partners</span>
  </div>
  <div class="proof-item">
    <span class="number">100%</span>
    <span class="label">Free Forever</span>
  </div>
</section>

<!-- Featured Post -->
{{- $pages := where site.RegularPages "Type" "in" site.Params.mainSections }}
{{- $pages = $pages.ByDate.Reverse }}
{{- if gt (len $pages) 0 }}
{{- $featured := index $pages 0 }}
<section class="featured-post">
  <div class="section-header">
    <span class="section-label">Featured</span>
    <h2>Latest from the Blog</h2>
  </div>
  <a href="{{ $featured.Permalink }}" style="text-decoration:none;color:inherit;">
  <div class="featured-card">
    <div class="card-image">
      {{- if $featured.Params.cover.image }}
      <img src="{{ $featured.Params.cover.image }}" alt="{{ $featured.Title }}" loading="lazy">
      {{- else }}
      <img src="/images/og-default.jpg" alt="{{ $featured.Title }}" loading="lazy">
      {{- end }}
    </div>
    <div class="card-body">
      <span class="featured-badge">★ Featured Article</span>
      {{- range $featured.Params.categories }}
      <span class="card-category" style="margin-left:0;">{{ . }}</span>
      {{- end }}
      <h3 class="card-title" style="font-size:1.6rem;">{{ $featured.Title }}</h3>
      <p class="card-excerpt">{{ $featured.Description }}</p>
      <div class="card-meta">
        <span class="card-meta-item">{{ $featured.Date.Format "Jan 2, 2006" }}</span>
        <span class="card-meta-item">{{ $featured.ReadingTime }} min read</span>
      </div>
    </div>
  </div>
  </a>
</section>

<!-- All Posts Grid -->
<section style="padding: 0 0 48px;">
  <div class="section-header">
    <span class="section-label">Articles</span>
    <h2>All Posts</h2>
    <p>Practical guides and science-backed insights to help you build lasting habits</p>
  </div>
  <div class="posts-grid">
    {{- range $pages }}
    <article class="post-card">
      <a href="{{ .Permalink }}" style="text-decoration:none;color:inherit;display:flex;flex-direction:column;height:100%;">
        <div class="card-image">
          {{- if .Params.cover.image }}
          <img src="{{ .Params.cover.image }}" alt="{{ .Title }}" loading="lazy" width="600" height="338">
          {{- else }}
          <img src="/images/og-default.jpg" alt="{{ .Title }}" loading="lazy" width="600" height="338">
          {{- end }}
        </div>
        <div class="card-body">
          {{- range .Params.categories }}
          <span class="card-category">{{ . }}</span>
          {{- end }}
          <h3 class="card-title">{{ .Title }}</h3>
          <p class="card-excerpt">{{ .Description }}</p>
          <div class="card-meta">
            <span class="card-meta-item">{{ .Date.Format "Jan 2, 2006" }}</span>
            <span class="card-meta-item">{{ .ReadingTime }} min read</span>
          </div>
        </div>
      </a>
    </article>
    {{- end }}
  </div>
</section>
{{- end }}

<!-- Testimonials -->
<section class="testimonials">
  <div class="section-header">
    <span class="section-label">What People Say</span>
    <h2>Loved by Habit Builders</h2>
    <p>Join thousands who are building better habits with accountability</p>
  </div>
  <div class="testimonial-grid">
    <div class="testimonial-card">
      <div class="stars">★★★★★</div>
      <p>"3act completely changed how I approach my daily habits. Having my friends see my progress keeps me honest and motivated every single day."</p>
      <span class="author">— Sarah M., App Store Review</span>
    </div>
    <div class="testimonial-card">
      <div class="stars">★★★★★</div>
      <p>"The accountability factor is real. I've tried dozens of habit trackers, but 3act is the first one that actually made me stick with my habits long-term."</p>
      <span class="author">— James K., App Store Review</span>
    </div>
    <div class="testimonial-card">
      <div class="stars">★★★★★</div>
      <p>"Simple, beautiful, and effective. My morning routine streak is at 60 days and counting. The social aspect makes all the difference."</p>
      <span class="author">— Priya R., App Store Review</span>
    </div>
  </div>
</section>

<!-- Subtle App CTA Banner — further down the page -->
<section style="max-width:var(--max-width);margin:0 auto;padding:0 24px 48px;">
  <div class="app-cta-banner">
    <h3>Ready to Build Habits That Actually Stick?</h3>
    <p>Join thousands using 3act to track habits, build streaks, and stay accountable with friends. 100% free.</p>
    <a href="https://apps.apple.com/app/id6756503513" class="btn-white" target="_blank" rel="noopener">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.8-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"/></svg>
      Download 3act Free
    </a>
  </div>
</section>

<!-- Newsletter -->
<section class="newsletter-section">
  <div class="section-header" style="margin-bottom:28px;">
    <span class="section-label">Newsletter</span>
    <h2>Get Weekly Habit Tips</h2>
    <p>Join our newsletter for science-backed habit strategies, accountability tips, and exclusive content delivered to your inbox.</p>
  </div>
  <form class="newsletter-form" action="https://blog.3act.app/" method="get" onsubmit="alert('Thanks for your interest! Newsletter coming soon.'); return false;">
    <input type="email" placeholder="Enter your email address" required>
    <button type="submit">Subscribe</button>
  </form>
  <p style="font-size:0.75rem;color:var(--dark-text-muted);margin-top:12px;">No spam, ever. Unsubscribe anytime.</p>
</section>

{{- else }}
<!-- Non-home list pages (categories, tags) -->
<div style="max-width:var(--max-width);margin:0 auto;padding:40px 24px;">
  <div class="section-header">
    <h2>{{ .Title }}</h2>
    {{ with .Description }}<p>{{ . }}</p>{{ end }}
  </div>
  
  {{- $pages := .Pages }}
  {{- if .IsSection }}
  {{- $pages = where .Pages "Type" "in" site.Params.mainSections }}
  {{- end }}
  
  <div class="posts-grid">
    {{- range $pages }}
    <article class="post-card">
      <a href="{{ .Permalink }}" style="text-decoration:none;color:inherit;display:flex;flex-direction:column;height:100%;">
        <div class="card-image">
          {{- if .Params.cover.image }}
          <img src="{{ .Params.cover.image }}" alt="{{ .Title }}" loading="lazy">
          {{- else }}
          <img src="/images/og-default.jpg" alt="{{ .Title }}" loading="lazy">
          {{- end }}
        </div>
        <div class="card-body">
          {{- range .Params.categories }}
          <span class="card-category">{{ . }}</span>
          {{- end }}
          <h3 class="card-title">{{ .Title }}</h3>
          <p class="card-excerpt">{{ .Description }}</p>
          <div class="card-meta">
            <span class="card-meta-item">{{ .Date.Format "Jan 2, 2006" }}</span>
            <span class="card-meta-item">{{ .ReadingTime }} min read</span>
          </div>
        </div>
      </a>
    </article>
    {{- end }}
  </div>
</div>
{{- end }}

{{- end }}{{- /* end main */ -}}
